<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>IAHash · Verify AI prompt–response pairs</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta
    name="description"
    content="IAHash is an open, model-agnostic standard to sign and verify AI-generated prompt–response pairs."
  />
  <link rel="stylesheet" href="/static/styles.css" />
</head>
<body>
  <header class="site-header">
    <div class="container header-inner">
      <a href="#hero" class="brand">
        <img src="/static/logo.png" alt="IAHash logo" class="brand-logo" />
        <span class="brand-text">IAHash</span>
      </a>
      <nav class="nav">
        <a href="#verify">Verify</a>
        <a href="#issue-from-text">Issue</a>
        <a href="#how-it-works">How it works</a>
        <a href="#use-cases">Use cases</a>
        <a href="#master-prompts">Master Prompts</a>
        <a href="#docs">Docs / Help</a>
      </nav>
    </div>
  </header>

  <main>
    <!-- HERO + VERIFIER -->
    <section id="hero" class="hero">
      <div class="container hero-inner">
        <div class="hero-copy">
          <h1>Trust that your AI really wrote this.</h1>
          <p class="hero-lead">
            IAHash is a lightweight, open standard to cryptographically verify
            that a prompt–response pair truly comes from your AI – and hasn’t been
            edited afterwards.
          </p>
          <ul class="hero-list">
            <li>✔ Integrity of the prompt and the response</li>
            <li>✔ Authenticity of the issuing AI / assistant</li>
            <li>✔ Offline verification, years later</li>
            <li>✔ No blockchain, no vendor lock-in</li>
          </ul>
          <p class="hero-sub">
            Paste an IAHash document on the right and get a
            <strong>iahash.com VERIFIED</strong> result in seconds.
          </p>
        </div>

        <div id="verify" class="hero-card">
          <h2>Verify an IAHash document</h2>
          <p class="card-subtitle">
            Paste the JSON document issued by your assistant or backend.
          </p>

          <form id="verify-form" class="verify-form">
            <label for="iah-json-input" class="field-label">
              IAHash JSON
            </label>
            <textarea
              id="iah-json-input"
              class="field-textarea"
              rows="14"
              spellcheck="false"
              placeholder='{
  "version": "IAHash-1",
  "prompt_id": "CV_v01",
  "prompt_description": "Write the most honest CV about the user...",
  "response": "AI response...",
  ...
}'
            ></textarea>

            <div class="form-actions">
              <button type="submit" class="btn btn-primary">Verify IAHash</button>
              <button type="button" id="clear-btn" class="btn btn-ghost">
                Clear
              </button>
            </div>
          </form>

          <div id="result" class="verify-result verify-result--idle">
            <div id="result-badge" class="verify-badge">
              <span class="badge-dot"></span>
              <span id="result-title">Waiting for a document…</span>
            </div>
            <p id="result-message" class="result-message">
              Paste a valid IAHash JSON document and click “Verify IAHash”.
            </p>
            <details class="result-details">
              <summary>Raw verification response</summary>
              <pre id="result-raw" class="result-raw">
(no response yet)
              </pre>
            </details>
          </div>
        </div>
      </div>
    </section>


    <!-- ISSUE FROM PROMPT + RESPONSE -->
    <section id="issue-from-text" class="section section-alt">
      <div class="container">
        <h2>Issue an IAHash document from Prompt + Response</h2>
        <p class="section-lead">
          Paste the exact raw prompt and the raw AI response to generate a cryptographically signed IAHash document.
        </p>

        <div class="hero-card" style="margin-top:20px;">
          <div class="verify-form">
            
            <label for="issue-model" class="field-label">Model (optional)</label>
            <input id="issue-model" type="text" class="field-textarea" style="height:34px;" placeholder="gpt-5.1-thinking" />

            <label for="issue-subject" class="field-label">Subject ID (optional)</label>
            <input id="issue-subject" type="text" class="field-textarea" style="height:34px;" placeholder="manu_cabral" />

            <label for="issue-prompt" class="field-label">Raw Prompt</label>
            <textarea id="issue-prompt" class="field-textarea" rows="10" spellcheck="false"></textarea>

            <label for="issue-response" class="field-label">Raw Response</label>
            <textarea id="issue-response" class="field-textarea" rows="14" spellcheck="false"></textarea>

            <div class="form-actions">
              <button id="issue-btn" class="btn btn-primary">Generate IAHash</button>
              <button type="button" id="issue-clear-btn" class="btn btn-ghost">Clear</button>
            </div>
          </div>

          <div id="issue-result" class="verify-result verify-result--idle" style="margin-top:14px; display:none;">
            <div class="verify-badge">
              <span class="badge-dot"></span>
              <span id="issue-title">Ready.</span>
            </div>
            <p id="issue-message" class="result-message">
              Paste data and click “Generate IAHash”.
            </p>
            <details class="result-details">
              <summary>IAHash Document</summary>
              <pre id="issue-json-output" class="result-raw">(empty)</pre>
            </details>
          </div>
        </div>
      </div>
    </section>
  </main>

  <footer class="site-footer">
    <div class="container footer-inner">
      <div class="footer-left">
        <span class="brand-text">IAHash</span>
        <span class="footer-divider">·</span>
        <span>Open, model-agnostic verification for AI output.</span>
      </div>
      <div class="footer-right">
        <a href="https://github.com/IAHASH/iahash" target="_blank" rel="noreferrer">
          GitHub
        </a>
        <span class="footer-divider">·</span>
        <span>Apache-2.0</span>
      </div>
    </div>
  </footer>

  <script>
    (function () {
      /* ----------------- EXISTING VERIFY LOGIC (UNCHANGED) ----------------- */

      const form = document.getElementById("verify-form");
      const input = document.getElementById("iah-json-input");
      const clearBtn = document.getElementById("clear-btn");

      const resultBox = document.getElementById("result");
      const resultTitle = document.getElementById("result-title");
      const resultMessage = document.getElementById("result-message");
      const resultRaw = document.getElementById("result-raw");
      const resultBadge = document.getElementById("result-badge");

      function setStateIdle() {
        resultBox.className = "verify-result verify-result--idle";
        resultTitle.textContent = "Waiting for a document…";
        resultMessage.textContent =
          "Paste a valid IAHash JSON document and click “Verify IAHash”.";
        resultRaw.textContent = "(no response yet)";
      }

      function setStateLoading() {
        resultBox.className = "verify-result verify-result--loading";
        resultTitle.textContent = "Verifying IAHash document…";
        resultMessage.textContent = "Contacting /verify endpoint.";
        resultRaw.textContent = "(awaiting response)";
      }

      function setStateError(msg) {
        resultBox.className = "verify-result verify-result--error";
        resultTitle.textContent = "Verification error";
        resultMessage.textContent = msg;
      }

      function setStateSuccess(isValid, data) {
        if (isValid) {
          resultBox.className = "verify-result verify-result--ok";
          resultTitle.textContent = "IAHash.com VERIFIED";
          resultMessage.textContent =
            "The IAHash document is valid and the signature matches.";
        } else {
          resultBox.className = "verify-result verify-result--fail";
          resultTitle.textContent = "NOT VERIFIED";
          resultMessage.textContent =
            "Hash or signature mismatch. The document is not authentic.";
        }

        try {
          resultRaw.textContent = JSON.stringify(data, null, 2);
        } catch {
          resultRaw.textContent = String(data);
        }
      }

      form.addEventListener("submit", async function (event) {
        event.preventDefault();

        let doc;
        try {
          doc = JSON.parse(input.value);
        } catch (err) {
          setStateError("Invalid JSON.");
          resultRaw.textContent = String(err);
          return;
        }

        setStateLoading();

        try {
          const res = await fetch("/verify", {
            method: "POST",
            headers: {
              "Content-Type": "application/json",
            },
            body: JSON.stringify(doc),
          });

          const data = await res.json();
          const isValid =
            data.valid === true ||
            data.status === "valid" ||
            data.verified === true;

          setStateSuccess(Boolean(isValid), data);
        } catch (err) {
          setStateError("Network or server error.");
          resultRaw.textContent = String(err);
        }
      });

      clearBtn.addEventListener("click", function () {
        input.value = "";
        setStateIdle();
      });

      setStateIdle();


      /* --------------- NEW IAHash ISSUER LOGIC (PROMPT + RESPONSE) --------------- */

      const issueBtn = document.getElementById("issue-btn");
      const issueClear = document.getElementById("issue-clear-btn");
      const issueResult = document.getElementById("issue-result");
      const issueMessage = document.getElementById("issue-message");
      const issueTitle = document.getElementById("issue-title");
      const issueOutput = document.getElementById("issue-json-output");

      issueBtn.addEventListener("click", async () => {
        const prompt = document.getElementById("issue-prompt").value.trim();
        const response = document.getElementById("issue-response").value.trim();
        const model = document.getElementById("issue-model").value.trim();
        const subject = document.getElementById("issue-subject").value.trim();

        if (!prompt || !response) {
          issueResult.style.display = "block";
          issueResult.className = "verify-result verify-result--error";
          issueTitle.textContent = "Missing data";
          issueMessage.textContent =
            "Both prompt and response are required to issue IAHash.";
          issueOutput.textContent = "";
          return;
        }

        issueResult.style.display = "block";
        issueResult.className = "verify-result verify-result--loading";
        issueTitle.textContent = "Issuing IAHash…";
        issueMessage.textContent = "Contacting /issue endpoint.";
        issueOutput.textContent = "(awaiting response)";

        try {
          const res = await fetch("/issue", {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({
              prompt_maestro: prompt,
              respuesta: response,
              modelo: model || "unknown",
              subject_id: subject || null
            }),
          });

          const data = await res.json();

          issueResult.className = "verify-result verify-result--ok";
          issueTitle.textContent = "IAHash issued ✔";
          issueMessage.textContent = "Copy and store the IAHash JSON.";

          issueOutput.textContent = JSON.stringify(data, null, 2);

        } catch (err) {
          issueResult.className = "verify-result verify-result--error";
          issueTitle.textContent = "Error";
          issueMessage.textContent = "Could not issue IAHash document.";
          issueOutput.textContent = String(err);
        }
      });

      issueClear.addEventListener("click", () => {
        document.getElementById("issue-prompt").value = "";
        document.getElementById("issue-response").value = "";
        document.getElementById("issue-model").value = "";
        document.getElementById("issue-subject").value = "";
        issueResult.style.display = "none";
      });
    })();
  </script>
</body>
</html>

